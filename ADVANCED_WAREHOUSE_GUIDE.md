# دليل استخدام صفحة إدارة المخازن المتقدمة

## الميزات الجديدة في صفحة إدارة المخازن المتقدمة

### 1. البيانات الأساسية للمخزن
- **اسم المخزن (عربي وإنجليزي)**: إدخال اسم المخزن بالعربية والإنجليزية
- **الفرع**: اختيار الفرع التابع له المخزن
- **العنوان**: تحديد موقع المخزن
- **الحالة**: اختيار من بين:
  - نشط (active)
  - غير نشط (inactive) 
  - متوقف (suspended)

### 2. ربط الحسابات المالية
- **مستوى الحساب**: اختيار مستوى الحساب (1، 2، 3، إلخ)
- **الحساب الأب**: اختيار الحساب الرئيسي الذي سيتم إنشاء حساب فرعي تحته
- **إنشاء حساب فرعي تلقائياً**: يتم إنشاء حساب فرعي للمخزن تلقائياً مع رمز مميز

### 3. إدارة المستخدمين
- عرض جدول بجميع المستخدمين المسجلين في النظام
- إمكانية تحديد المستخدمين المسموح لهم بالوصول للمخزن
- نظام Checkbox لسهولة التحديد والإلغاء

### 4. إدارة الفروع
- عرض جدول بجميع الفروع في النظام
- إمكانية تحديد الفروع المسموح لها بالوصول للمخزن
- نظام Checkbox لسهولة التحديد والإلغاء

### 5. تحديد نوع الاستخدام
#### أ. استخدام الفواتير
عند اختيار "فاتورة" يظهر خيارات:
- فاتورة مبيعات
- فاتورة مشتريات
- الكل

#### ب. استخدام المخزن
عند اختيار "مخزن" يظهر خيارات:
- إذن إضافة مخزن
- إذن صرف مخزن
- تحويلات بين المخازن

## كيفية الوصول للصفحة
1. من القائمة الجانبية، اختر "إدارة المخازن"
2. ثم اختر "إدارة المخازن المتقدمة"
3. أو اذهب مباشرة إلى: `/stores/advanced-warehouse`

## طريقة الاستخدام

### إضافة مخزن جديد:
1. اضغط على زر "إضافة مخزن"
2. املأ البيانات الأساسية في التبويب الأول
3. انتقل إلى تبويب "المستخدمين" وحدد المستخدمين المسموح لهم
4. انتقل إلى تبويب "الفروع" وحدد الفروع المسموح لها
5. انتقل إلى تبويب "الاستخدام" وحدد نوع الاستخدام
6. اضغط "حفظ"

### تعديل مخزن موجود:
1. اضغط على أيقونة التعديل بجانب المخزن المطلوب
2. عدل البيانات في التبويبات المختلفة
3. اضغط "حفظ"

### حذف مخزن:
1. اضغط على أيقونة الحذف بجانب المخزن المطلوب
2. سيتم حذف المخزن والحساب الفرعي المرتبط به

## المميزات التقنية
- **واجهة Ant Design**: تصميم احترافي ومتجاوب
- **Tabs Navigation**: تنظيم البيانات في تبويبات منفصلة
- **Real-time Updates**: تحديث البيانات فوري
- **Error Handling**: معالجة الأخطاء وعرض رسائل مناسبة
- **Validation**: التحقق من صحة البيانات قبل الحفظ
- **Auto Sub-Account Creation**: إنشاء الحسابات الفرعية تلقائياً

## الملفات المضافة/المحدثة
1. `src/pages/stores/AdvancedWarehouseManagement.tsx` - الصفحة الرئيسية
2. `src/services/warehouseService.ts` - خدمة إدارة المخازن
3. `src/pages/Index.tsx` - إضافة المسار الجديد
4. `src/utils/sidebarMenus.ts` - إضافة رابط في القائمة الجانبية

## نصائح للاستخدام
- تأكد من ملء جميع الحقول المطلوبة (*)
- يمكن ترك حقل العنوان فارغاً إذا لم يكن متاحاً
- الحساب الفرعي يُنشأ تلقائياً بناءً على اسم المخزن والحساب الأب
- يمكن تعديل صلاحيات المستخدمين والفروع في أي وقت
- حذف المخزن سيحذف أيضاً الحساب الفرعي المرتبط به

## استعلامات مفيدة
- `fetchWarehouses()` - جلب جميع المخازن
- `fetchWarehousesByBranch(branchId)` - جلب مخازن فرع معين
- `fetchActiveWarehouses()` - جلب المخازن النشطة فقط
- `fetchWarehousesByUser(userId)` - جلب المخازن المسموح للمستخدم بالوصول إليها
- `fetchWarehousesByOperationType(type)` - جلب المخازن حسب نوع العملية
